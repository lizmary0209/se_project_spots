!function(){"use strict";const e={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-btn",inactiveButtonClass:"modal__submit-btn_inactive",inputErrorClass:"modal__input_type_error",errorClass:"modal__error"},t=(e,t,r)=>{e.querySelector(`#${t.id}-error`).textContent="",t.classList.remove(r.inputErrorClass)},r=(e,t,r)=>{(e=>e.some(e=>!e.validity.valid))(e)?n(t,r):o(t,r)},n=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)},o=(e,t)=>{e.disabled=!1,e.classList.remove(t.inactiveButtonClass)};function a(e,t,r="Save",n="Saving..."){e.textContent=t?n:r}const s=new class{constructor({baseUrl:e,headers:t}){this._baseUrl=e,this._headers=t}_handleResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getAppInfo(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._handleResponse)}editUserInfo({name:e,about:t}){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(this._handleResponse)}updateAvatar({avatar:e}){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._handleResponse)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._handleResponse)}addNewCard({name:e,link:t}){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(this._handleResponse)}deleteCard({id:e}){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._handleResponse)}addLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(e=>this._handleResponse(e))}removeLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(e=>this._handleResponse(e))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"7693afef-dcd9-4d4b-a9c3-9f72d6b208e9","Content-Type":"application/json"}}),l=document.querySelector(".profile__name"),c=document.querySelector(".profile__description"),i=document.querySelector(".profile__avatar"),d=document.querySelector("#edit-profile-modal"),u=document.querySelector("#new-post-modal"),m=document.querySelector("#preview-modal"),_=document.querySelector("#avatar-modal"),h=document.querySelector("#delete-modal"),p=document.querySelectorAll(".modal"),v=document.forms["edit-profile-form"],y=u.querySelector(".modal__form"),f=_.querySelector("#edit-avatar-form"),S=h.querySelector("#modal__delete-form"),b=document.querySelector(".profile__edit-btn"),q=document.querySelector(".profile__new-post-btn"),L=document.querySelector(".profile__avatar-btn"),E=d.querySelector("#profile-name-input"),k=d.querySelector("#profile-description-input"),C=document.querySelector("#caption-input"),g=document.querySelector("#card-image-input"),U=f.querySelector("#profile-avatar-input"),$=(v.querySelector('button[type="submit"]'),y.querySelector('button[type="submit"]'),f.querySelector('button[type="submit"]'),S.querySelector('button[type="submit"]')),A=d.querySelector(".modal__close-btn"),x=u.querySelector(".modal__close-btn"),w=m.querySelector(".modal__close_type_preview"),D=_.querySelector(".modal__close-btn"),R=h.querySelector(".modal__delete_close-btn"),I=document.querySelector("#card-template").content.querySelector(".card"),T=document.querySelector(".cards__list");let B=null,N=null;function P(e){if("Escape"===e.key){const e=document.querySelector(".modal_is-opened");e&&j(e)}}function O(e){e.classList.add("modal_is-opened"),document.addEventListener("keydown",P)}function j(e){e.classList.remove("modal_is-opened"),document.removeEventListener("keydown",P)}function J(e,t="prepend"){const r=function(e){const t=I.cloneNode(!0),r=t.querySelector(".card__title"),n=t.querySelector(".card__image"),o=t.querySelector(".card__delete-btn"),a=t.querySelector(".card__like-btn");return n.src=e.link,n.alt=e.name,r.textContent=e.name,e.isLiked&&a.classList.add("card__like-btn_active"),a.addEventListener("click",()=>{a.classList.contains("card__like-btn_active")?s.removeLike(e._id).then(()=>a.classList.remove("card__like-btn_active")).catch(console.error):s.addLike(e._id).then(()=>a.classList.add("card__like-btn_active")).catch(console.error)}),o.addEventListener("click",()=>function(e,t){B=e,N=t,O(h)}(t,e._id)),n.addEventListener("click",()=>{const t=m.querySelector(".modal__image"),r=m.querySelector(".modal__caption");t.src=e.link,t.alt=e.name,r.textContent=e.name,O(m)}),t}(e);T[t](r)}var H;h.querySelector(".modal__cancel-btn").addEventListener("click",()=>{B=null,N=null,j(h)}),S.addEventListener("submit",e=>{e.preventDefault(),N&&(a($,!0,"Delete","Deleting..."),s.deleteCard({id:N}).then(()=>{B.remove(),B=null,N=null,j(h)}).catch(console.error).finally(()=>{a($,!1,"Delete","Deleting...")}))}),p.forEach(e=>{e.addEventListener("click",t=>{(t.target===e||t.target.classList.contains("modal__close-btn")||t.target.classList.contains("modal__close_type_preview"))&&j(e)})}),s.getAppInfo().then(([e,t])=>{l.textContent=e.name,c.textContent=e.about,i.src=e.avatar,t.forEach(e=>J(e,"append"))}).catch(console.error),b.addEventListener("click",()=>{E.value=l.textContent,k.value=c.textContent,((e,n)=>{const o=Array.from(e.querySelectorAll(n.inputSelector)),a=e.querySelector(n.submitButtonSelector);o.forEach(r=>{t(e,r,n)}),r(o,a,n)})(v,e),O(d)}),q.addEventListener("click",()=>O(u)),L.addEventListener("click",()=>O(_)),A.addEventListener("click",()=>j(d)),x.addEventListener("click",()=>j(u)),w.addEventListener("click",()=>j(m)),D.addEventListener("click",()=>j(_)),R.addEventListener("click",()=>j(h)),v.addEventListener("submit",e=>{e.preventDefault();const t=e.submitter;a(t,!0),s.editUserInfo({name:E.value,about:k.value}).then(e=>{l.textContent=e.name,c.textContent=e.about,j(d)}).catch(console.error).finally(()=>a(t,!1))}),y.addEventListener("submit",e=>{e.preventDefault();const t=e.submitter;a(t,!0);const r={name:C.value,link:g.value};s.addNewCard(r).then(e=>{J(e,"prepend"),y.reset(),j(u)}).catch(console.error).finally(()=>a(t,!1))}),f.addEventListener("submit",e=>{e.preventDefault();const t=e.submitter;a(t,!0),s.updateAvatar({avatar:U.value}).then(e=>{i.src=e.avatar,f.reset(),j(_)}).catch(console.error).finally(()=>a(t,!1))}),H=e,document.querySelectorAll(H.formSelector).forEach(e=>{((e,o)=>{const a=Array.from(e.querySelectorAll(o.inputSelector)),s=e.querySelector(o.submitButtonSelector);r(a,s,o),e.addEventListener("reset",()=>{n(s,o)}),a.forEach(n=>{n.addEventListener("input",function(){((e,r,n)=>{r.validity.valid?t(e,r,n):((e,t,r,n)=>{e.querySelector(`#${t.id}-error`).textContent=r,t.classList.add(n.inputErrorClass)})(e,r,r.validationMessage,n)})(e,n,o),r(a,s,o)})})})(e,H)})}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFBT1Asc0JBRTdDYSxFQUFrQkMsRUFBV0MsRUFBVVIsR0FDdkNGLEVBQU9xRyxpQkFBaUIsUUFBUyxLQUMvQnJGLEVBQWNOLEVBQVVSLEtBRzFCTyxFQUFVc0gsUUFBUzlILElBQ2pCQSxFQUFRb0csaUJBQWlCLFFBQVMsV0FyRFh3QyxFQUFDN0ksRUFBUUMsRUFBU0MsS0FDdENELEVBQVFhLFNBQVNDLE1BR3BCaEIsRUFBZUMsRUFBUUMsRUFBU0MsR0FoQmI0SSxFQUFDOUksRUFBUUMsRUFBUzhJLEVBQVU3SSxLQUM5QkYsRUFBT0csY0FBYyxJQUFJRixFQUFRRyxZQUN6Q0MsWUFBYzBJLEVBQ3pCOUksRUFBUUssVUFBVWEsSUFBSWpCLEVBQU9MLGtCQVczQmlKLENBQWU5SSxFQUFRQyxFQUFTQSxFQUFRK0ksa0JBQW1COUksSUFvRHpEMkksQ0FBbUI3SSxFQUFRQyxFQUFTQyxHQUNwQ00sRUFBa0JDLEVBQVdDLEVBQVVSLEVBQ3pDLE1BT0EwSSxDQUFrQjVJLEVBQVFFLEkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3NjcmlwdHMvdmFsaWRhdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL2hlbHBlcnMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL0FwaS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgdmFsaWRhdGlvbkNvbmZpZyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zdWJtaXQtYnRuXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc3VibWl0LWJ0bl9pbmFjdGl2ZVwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yXCIsXHJcbn07XHJcblxyXG5jb25zdCBzaG93SW5wdXRFcnJvciA9IChmb3JtRWwsIGlucHV0RWwsIGVycm9yTXNnLCBjb25maWcpID0+IHtcclxuICBjb25zdCBlcnJvck1zZ0VsID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgZXJyb3JNc2dFbC50ZXh0Q29udGVudCA9IGVycm9yTXNnO1xyXG4gIGlucHV0RWwuY2xhc3NMaXN0LmFkZChjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxufTtcclxuXHJcbmNvbnN0IGhpZGVJbnB1dEVycm9yID0gKGZvcm1FbCwgaW5wdXRFbCwgY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgZXJyb3JNc2dFbCA9IGZvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xyXG4gIGVycm9yTXNnRWwudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxufTtcclxuXHJcbmNvbnN0IGNoZWNrSW5wdXRWYWxpZGl0eSA9IChmb3JtRWwsIGlucHV0RWwsIGNvbmZpZykgPT4ge1xyXG4gIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgc2hvd0lucHV0RXJyb3IoZm9ybUVsLCBpbnB1dEVsLCBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlLCBjb25maWcpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWwsIGlucHV0RWwsIGNvbmZpZyk7XHJcbiAgfVxyXG59O1xyXG5cclxuY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdCwgY29uZmlnKSA9PiB7XHJcbiAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dCkgPT4ge1xyXG4gICAgcmV0dXJuICFpbnB1dC52YWxpZGl0eS52YWxpZDtcclxuICB9KTtcclxufTtcclxuXHJcbmNvbnN0IHRvZ2dsZUJ1dHRvblN0YXRlID0gKGlucHV0TGlzdCwgYnV0dG9uRWwsIGNvbmZpZykgPT4ge1xyXG4gIGlmIChoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xyXG4gICAgZGlzYWJsZUJ1dHRvbihidXR0b25FbCwgY29uZmlnKTtcclxuICB9IGVsc2Uge1xyXG4gICAgZW5hYmxlQnV0dG9uKGJ1dHRvbkVsLCBjb25maWcpO1xyXG4gIH1cclxufTtcclxuXHJcbmNvbnN0IGRpc2FibGVCdXR0b24gPSAoYnV0dG9uRWwsIGNvbmZpZykgPT4ge1xyXG4gIGJ1dHRvbkVsLmRpc2FibGVkID0gdHJ1ZTtcclxuICBidXR0b25FbC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxufTtcclxuXHJcbmNvbnN0IGVuYWJsZUJ1dHRvbiA9IChidXR0b25FbCwgY29uZmlnKSA9PiB7XHJcbiAgYnV0dG9uRWwuZGlzYWJsZWQgPSBmYWxzZTtcclxuICBidXR0b25FbC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCByZXNldFZhbGlkYXRpb24gPSAoZm9ybUVsLCBjb25maWcpID0+IHtcclxuICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKGZvcm1FbC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKSk7XHJcbiAgY29uc3QgYnV0dG9uRWwgPSBmb3JtRWwucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG5cclxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXQsIGNvbmZpZyk7XHJcbiAgfSk7XHJcblxyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWwsIGNvbmZpZyk7XHJcbn07XHJcblxyXG5jb25zdCBzZXRFdmVudExpc3RlbmVycyA9IChmb3JtRWwsIGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oZm9ybUVsLnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmlucHV0U2VsZWN0b3IpKTtcclxuICBjb25zdCBidXR0b25FbCA9IGZvcm1FbC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcblxyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWwsIGNvbmZpZyk7XHJcbiAgZm9ybUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNldFwiLCAoKSA9PiB7XHJcbiAgICBkaXNhYmxlQnV0dG9uKGJ1dHRvbkVsLCBjb25maWcpO1xyXG4gIH0pO1xyXG5cclxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xyXG4gICAgaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpO1xyXG4gICAgICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsLCBjb25maWcpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChjb25maWcpID0+IHtcclxuICBjb25zdCBmb3JtTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3Rvcik7XHJcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsKSA9PiB7XHJcbiAgICBzZXRFdmVudExpc3RlbmVycyhmb3JtRWwsIGNvbmZpZyk7XHJcbiAgfSk7XHJcbn07XHJcbiIsImV4cG9ydCBmdW5jdGlvbiBzZXRCdXR0b25UZXh0KFxyXG4gIGJ0bixcclxuICBpc0xvYWRpbmcsXHJcbiAgZGVmYXVsdFRleHQgPSBcIlNhdmVcIixcclxuICBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCJcclxuKSB7XHJcbiAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgYnRuLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XHJcbiAgfSBlbHNlIHtcclxuICAgIGJ0bi50ZXh0Q29udGVudCA9IGRlZmF1bHRUZXh0O1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQge1xyXG4gIGVuYWJsZVZhbGlkYXRpb24sXHJcbiAgdmFsaWRhdGlvbkNvbmZpZyxcclxuICByZXNldFZhbGlkYXRpb24sXHJcbn0gZnJvbSBcIi4uL3NjcmlwdHMvdmFsaWRhdGlvbi5qc1wiO1xyXG5pbXBvcnQgeyBzZXRCdXR0b25UZXh0IH0gZnJvbSBcIi4uL3V0aWxzL2hlbHBlcnMuanNcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vdXRpbHMvQXBpLmpzXCI7XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCI3NjkzYWZlZi1kY2Q5LTRkNGItYTljMy05ZjcyZDZiMjA4ZTlcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxuY29uc3QgcHJvZmlsZU5hbWVFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTtcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xyXG5jb25zdCBwcm9maWxlQXZhdGFyRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhclwiKTtcclxuXHJcbmNvbnN0IGVkaXRQcm9maWxlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtcHJvZmlsZS1tb2RhbFwiKTtcclxuY29uc3QgbmV3UG9zdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNuZXctcG9zdC1tb2RhbFwiKTtcclxuY29uc3QgcHJldmlld01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmV2aWV3LW1vZGFsXCIpO1xyXG5jb25zdCBhdmF0YXJNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLW1vZGFsXCIpO1xyXG5jb25zdCBkZWxldGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVsZXRlLW1vZGFsXCIpO1xyXG5jb25zdCBtb2RhbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsXCIpO1xyXG5cclxuY29uc3QgZWRpdFByb2ZpbGVGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJlZGl0LXByb2ZpbGUtZm9ybVwiXTtcclxuY29uc3QgbmV3UG9zdEZvcm0gPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuY29uc3QgYXZhdGFyRm9ybSA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1hdmF0YXItZm9ybVwiKTtcclxuY29uc3QgZGVsZXRlRm9ybSA9IGRlbGV0ZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWxfX2RlbGV0ZS1mb3JtXCIpO1xyXG5cclxuY29uc3QgZWRpdFByb2ZpbGVCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnRuXCIpO1xyXG5jb25zdCBuZXdQb3N0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uZXctcG9zdC1idG5cIik7XHJcbmNvbnN0IGF2YXRhck1vZGFsQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXItYnRuXCIpO1xyXG5cclxuY29uc3QgZWRpdFByb2ZpbGVOYW1lSW5wdXQgPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIjcHJvZmlsZS1uYW1lLWlucHV0XCJcclxuKTtcclxuY29uc3QgZWRpdERlc2NyaXB0aW9uSW5wdXQgPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiXHJcbik7XHJcbmNvbnN0IG5ld1Bvc3RDYXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXB0aW9uLWlucHV0XCIpO1xyXG5jb25zdCBuZXdQb3N0SW1hZ2VJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1pbWFnZS1pbnB1dFwiKTtcclxuY29uc3QgYXZhdGFySW5wdXQgPSBhdmF0YXJGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1hdmF0YXItaW5wdXRcIik7XHJcblxyXG5jb25zdCBlZGl0UHJvZmlsZVN1Ym1pdEJ0biA9IGVkaXRQcm9maWxlRm9ybS5xdWVyeVNlbGVjdG9yKFxyXG4gICdidXR0b25bdHlwZT1cInN1Ym1pdFwiXSdcclxuKTtcclxuY29uc3QgbmV3UG9zdFN1Ym1pdEJ0biA9IG5ld1Bvc3RGb3JtLnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvblt0eXBlPVwic3VibWl0XCJdJyk7XHJcbmNvbnN0IGF2YXRhclN1Ym1pdEJ0biA9IGF2YXRhckZvcm0ucXVlcnlTZWxlY3RvcignYnV0dG9uW3R5cGU9XCJzdWJtaXRcIl0nKTtcclxuY29uc3QgZGVsZXRlU3VibWl0QnRuID0gZGVsZXRlRm9ybS5xdWVyeVNlbGVjdG9yKCdidXR0b25bdHlwZT1cInN1Ym1pdFwiXScpO1xyXG5cclxuY29uc3QgZWRpdFByb2ZpbGVDbG9zZUJ0biA9IGVkaXRQcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnRuXCIpO1xyXG5jb25zdCBuZXdQb3N0Q2xvc2VCdG4gPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnRuXCIpO1xyXG5jb25zdCBwcmV2aWV3TW9kYWxDbG9zZUJ0biA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLm1vZGFsX19jbG9zZV90eXBlX3ByZXZpZXdcIlxyXG4pO1xyXG5jb25zdCBhdmF0YXJDbG9zZUJ0biA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ0blwiKTtcclxuY29uc3QgYXZhdGFyTW9kYWxEZWxldGVCdG4gPSBkZWxldGVNb2RhbC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLm1vZGFsX19kZWxldGVfY2xvc2UtYnRuXCJcclxuKTtcclxuXHJcbmNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50XHJcbiAgLnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKVxyXG4gIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKTtcclxuY29uc3QgY2FyZHNMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcclxuXHJcbmxldCBzZWxlY3RlZENhcmQgPSBudWxsO1xyXG5sZXQgc2VsZWN0ZWRDYXJkSWQgPSBudWxsO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlQ2FyZERlbGV0ZShjYXJkRWxlbWVudCwgY2FyZElkKSB7XHJcbiAgc2VsZWN0ZWRDYXJkID0gY2FyZEVsZW1lbnQ7XHJcbiAgc2VsZWN0ZWRDYXJkSWQgPSBjYXJkSWQ7XHJcbiAgb3Blbk1vZGFsKGRlbGV0ZU1vZGFsKTtcclxufVxyXG5cclxuY29uc3QgY2FuY2VsQnRuID0gZGVsZXRlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FuY2VsLWJ0blwiKTtcclxuXHJcbmNhbmNlbEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIHNlbGVjdGVkQ2FyZCA9IG51bGw7XHJcbiAgc2VsZWN0ZWRDYXJkSWQgPSBudWxsO1xyXG4gIGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpO1xyXG59KTtcclxuXHJcbmRlbGV0ZUZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgaWYgKCFzZWxlY3RlZENhcmRJZCkgcmV0dXJuO1xyXG5cclxuICBzZXRCdXR0b25UZXh0KGRlbGV0ZVN1Ym1pdEJ0biwgdHJ1ZSwgXCJEZWxldGVcIiwgXCJEZWxldGluZy4uLlwiKTtcclxuXHJcbiAgYXBpXHJcbiAgICAuZGVsZXRlQ2FyZCh7IGlkOiBzZWxlY3RlZENhcmRJZCB9KVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICBzZWxlY3RlZENhcmQucmVtb3ZlKCk7XHJcbiAgICAgIHNlbGVjdGVkQ2FyZCA9IG51bGw7XHJcbiAgICAgIHNlbGVjdGVkQ2FyZElkID0gbnVsbDtcclxuICAgICAgY2xvc2VNb2RhbChkZWxldGVNb2RhbCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHNldEJ1dHRvblRleHQoZGVsZXRlU3VibWl0QnRuLCBmYWxzZSwgXCJEZWxldGVcIiwgXCJEZWxldGluZy4uLlwiKTtcclxuICAgIH0pO1xyXG59KTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUVzY0Nsb3NlKGV2dCkge1xyXG4gIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICBjb25zdCBvcGVuTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX2lzLW9wZW5lZFwiKTtcclxuICAgIGlmIChvcGVuTW9kYWwpIGNsb3NlTW9kYWwob3Blbk1vZGFsKTtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG9wZW5Nb2RhbChtb2RhbCkge1xyXG4gIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9pcy1vcGVuZWRcIik7XHJcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlRXNjQ2xvc2UpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjbG9zZU1vZGFsKG1vZGFsKSB7XHJcbiAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX2lzLW9wZW5lZFwiKTtcclxuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NDbG9zZSk7XHJcbn1cclxuXHJcbm1vZGFscy5mb3JFYWNoKChtb2RhbCkgPT4ge1xyXG4gIG1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XHJcbiAgICBpZiAoXHJcbiAgICAgIGV2dC50YXJnZXQgPT09IG1vZGFsIHx8XHJcbiAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX2Nsb3NlLWJ0blwiKSB8fFxyXG4gICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19jbG9zZV90eXBlX3ByZXZpZXdcIilcclxuICAgICkge1xyXG4gICAgICBjbG9zZU1vZGFsKG1vZGFsKTtcclxuICAgIH1cclxuICB9KTtcclxufSk7XHJcblxyXG5mdW5jdGlvbiBnZXRDYXJkRWxlbWVudChkYXRhKSB7XHJcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkVGVtcGxhdGUuY2xvbmVOb2RlKHRydWUpO1xyXG4gIGNvbnN0IGNhcmRUaXRsZUVsID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcclxuICBjb25zdCBjYXJkSW1hZ2VFbCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgY29uc3QgY2FyZERlbGV0ZUJ0bkVsID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnRuXCIpO1xyXG4gIGNvbnN0IGNhcmRMaWtlQnRuRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnRuXCIpO1xyXG5cclxuICBjYXJkSW1hZ2VFbC5zcmMgPSBkYXRhLmxpbms7XHJcbiAgY2FyZEltYWdlRWwuYWx0ID0gZGF0YS5uYW1lO1xyXG4gIGNhcmRUaXRsZUVsLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG5cclxuICBpZiAoZGF0YS5pc0xpa2VkKSBjYXJkTGlrZUJ0bkVsLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ0bl9hY3RpdmVcIik7XHJcblxyXG4gIGNhcmRMaWtlQnRuRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIGNvbnN0IGlzTGlrZWQgPSBjYXJkTGlrZUJ0bkVsLmNsYXNzTGlzdC5jb250YWlucyhcImNhcmRfX2xpa2UtYnRuX2FjdGl2ZVwiKTtcclxuICAgIGlmICghaXNMaWtlZCkge1xyXG4gICAgICBhcGlcclxuICAgICAgICAuYWRkTGlrZShkYXRhLl9pZClcclxuICAgICAgICAudGhlbigoKSA9PiBjYXJkTGlrZUJ0bkVsLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ0bl9hY3RpdmVcIikpXHJcbiAgICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgYXBpXHJcbiAgICAgICAgLnJlbW92ZUxpa2UoZGF0YS5faWQpXHJcbiAgICAgICAgLnRoZW4oKCkgPT4gY2FyZExpa2VCdG5FbC5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idG5fYWN0aXZlXCIpKVxyXG4gICAgICAgIC5jYXRjaChjb25zb2xlLmVycm9yKTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgY2FyZERlbGV0ZUJ0bkVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxyXG4gICAgaGFuZGxlQ2FyZERlbGV0ZShjYXJkRWxlbWVudCwgZGF0YS5faWQpXHJcbiAgKTtcclxuXHJcbiAgY2FyZEltYWdlRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIGNvbnN0IHByZXZpZXdJbWFnZUVsID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xyXG4gICAgY29uc3QgcHJldmlld01vZGFsQ2FwdGlvbkVsID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhcHRpb25cIik7XHJcbiAgICBwcmV2aWV3SW1hZ2VFbC5zcmMgPSBkYXRhLmxpbms7XHJcbiAgICBwcmV2aWV3SW1hZ2VFbC5hbHQgPSBkYXRhLm5hbWU7XHJcbiAgICBwcmV2aWV3TW9kYWxDYXB0aW9uRWwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgICBvcGVuTW9kYWwocHJldmlld01vZGFsKTtcclxuICB9KTtcclxuXHJcbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG59XHJcblxyXG5mdW5jdGlvbiByZW5kZXJDYXJkKGl0ZW0sIG1ldGhvZCA9IFwicHJlcGVuZFwiKSB7XHJcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChpdGVtKTtcclxuICBjYXJkc0xpc3RbbWV0aG9kXShjYXJkRWxlbWVudCk7XHJcbn1cclxuXHJcbmFwaVxyXG4gIC5nZXRBcHBJbmZvKClcclxuICAudGhlbigoW3VzZXJEYXRhLCBjYXJkc10pID0+IHtcclxuICAgIHByb2ZpbGVOYW1lRWwudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5uYW1lO1xyXG4gICAgcHJvZmlsZURlc2NyaXB0aW9uRWwudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5hYm91dDtcclxuICAgIHByb2ZpbGVBdmF0YXJFbC5zcmMgPSB1c2VyRGF0YS5hdmF0YXI7XHJcbiAgICBjYXJkcy5mb3JFYWNoKChpdGVtKSA9PiByZW5kZXJDYXJkKGl0ZW0sIFwiYXBwZW5kXCIpKTtcclxuICB9KVxyXG4gIC5jYXRjaChjb25zb2xlLmVycm9yKTtcclxuXHJcbmVkaXRQcm9maWxlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgZWRpdFByb2ZpbGVOYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlTmFtZUVsLnRleHRDb250ZW50O1xyXG4gIGVkaXREZXNjcmlwdGlvbklucHV0LnZhbHVlID0gcHJvZmlsZURlc2NyaXB0aW9uRWwudGV4dENvbnRlbnQ7XHJcbiAgcmVzZXRWYWxpZGF0aW9uKGVkaXRQcm9maWxlRm9ybSwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgb3Blbk1vZGFsKGVkaXRQcm9maWxlTW9kYWwpO1xyXG59KTtcclxubmV3UG9zdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gb3Blbk1vZGFsKG5ld1Bvc3RNb2RhbCkpO1xyXG5hdmF0YXJNb2RhbEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gb3Blbk1vZGFsKGF2YXRhck1vZGFsKSk7XHJcblxyXG5lZGl0UHJvZmlsZUNsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxyXG4gIGNsb3NlTW9kYWwoZWRpdFByb2ZpbGVNb2RhbClcclxuKTtcclxubmV3UG9zdENsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBjbG9zZU1vZGFsKG5ld1Bvc3RNb2RhbCkpO1xyXG5wcmV2aWV3TW9kYWxDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gY2xvc2VNb2RhbChwcmV2aWV3TW9kYWwpKTtcclxuYXZhdGFyQ2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGNsb3NlTW9kYWwoYXZhdGFyTW9kYWwpKTtcclxuYXZhdGFyTW9kYWxEZWxldGVCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpKTtcclxuXHJcbmVkaXRQcm9maWxlRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICBjb25zdCBzdWJtaXRCdG4gPSBldnQuc3VibWl0dGVyO1xyXG4gIHNldEJ1dHRvblRleHQoc3VibWl0QnRuLCB0cnVlKTtcclxuXHJcbiAgYXBpXHJcbiAgICAuZWRpdFVzZXJJbmZvKHtcclxuICAgICAgbmFtZTogZWRpdFByb2ZpbGVOYW1lSW5wdXQudmFsdWUsXHJcbiAgICAgIGFib3V0OiBlZGl0RGVzY3JpcHRpb25JbnB1dC52YWx1ZSxcclxuICAgIH0pXHJcbiAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICBwcm9maWxlTmFtZUVsLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgICBwcm9maWxlRGVzY3JpcHRpb25FbC50ZXh0Q29udGVudCA9IGRhdGEuYWJvdXQ7XHJcbiAgICAgIGNsb3NlTW9kYWwoZWRpdFByb2ZpbGVNb2RhbCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAuZmluYWxseSgoKSA9PiBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ0biwgZmFsc2UpKTtcclxufSk7XHJcblxyXG5uZXdQb3N0Rm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICBjb25zdCBzdWJtaXRCdG4gPSBldnQuc3VibWl0dGVyO1xyXG4gIHNldEJ1dHRvblRleHQoc3VibWl0QnRuLCB0cnVlKTtcclxuXHJcbiAgY29uc3QgY2FyZERhdGEgPSB7XHJcbiAgICBuYW1lOiBuZXdQb3N0Q2FwdGlvbi52YWx1ZSxcclxuICAgIGxpbms6IG5ld1Bvc3RJbWFnZUlucHV0LnZhbHVlLFxyXG4gIH07XHJcblxyXG4gIGFwaVxyXG4gICAgLmFkZE5ld0NhcmQoY2FyZERhdGEpXHJcbiAgICAudGhlbigobmV3Q2FyZCkgPT4ge1xyXG4gICAgICByZW5kZXJDYXJkKG5ld0NhcmQsIFwicHJlcGVuZFwiKTtcclxuICAgICAgbmV3UG9zdEZvcm0ucmVzZXQoKTtcclxuICAgICAgY2xvc2VNb2RhbChuZXdQb3N0TW9kYWwpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4gc2V0QnV0dG9uVGV4dChzdWJtaXRCdG4sIGZhbHNlKSk7XHJcbn0pO1xyXG5cclxuYXZhdGFyRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICBjb25zdCBzdWJtaXRCdG4gPSBldnQuc3VibWl0dGVyO1xyXG4gIHNldEJ1dHRvblRleHQoc3VibWl0QnRuLCB0cnVlKTtcclxuXHJcbiAgYXBpXHJcbiAgICAudXBkYXRlQXZhdGFyKHsgYXZhdGFyOiBhdmF0YXJJbnB1dC52YWx1ZSB9KVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgcHJvZmlsZUF2YXRhckVsLnNyYyA9IGRhdGEuYXZhdGFyO1xyXG4gICAgICBhdmF0YXJGb3JtLnJlc2V0KCk7XHJcbiAgICAgIGNsb3NlTW9kYWwoYXZhdGFyTW9kYWwpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4gc2V0QnV0dG9uVGV4dChzdWJtaXRCdG4sIGZhbHNlKSk7XHJcbn0pO1xyXG5cclxuZW5hYmxlVmFsaWRhdGlvbih2YWxpZGF0aW9uQ29uZmlnKTtcclxuIiwiY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICB9XHJcblxyXG4gIF9oYW5kbGVSZXNwb25zZShyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfVxyXG5cclxuICBnZXRBcHBJbmZvKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldFVzZXJJbmZvKCksIHRoaXMuZ2V0SW5pdGlhbENhcmRzKCldKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBlZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IG5hbWUsIGFib3V0IH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVBdmF0YXIoeyBhdmF0YXIgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgYXZhdGFyIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGFkZE5ld0NhcmQoeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lLCBsaW5rIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKHsgaWQgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGFkZExpa2UoaWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB0aGlzLl9oYW5kbGVSZXNwb25zZShyZXMpKTtcclxuICB9XHJcblxyXG4gIHJlbW92ZUxpa2UoaWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB0aGlzLl9oYW5kbGVSZXNwb25zZShyZXMpKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEFwaTtcclxuIl0sIm5hbWVzIjpbInZhbGlkYXRpb25Db25maWciLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsImhpZGVJbnB1dEVycm9yIiwiZm9ybUVsIiwiaW5wdXRFbCIsImNvbmZpZyIsInF1ZXJ5U2VsZWN0b3IiLCJpZCIsInRleHRDb250ZW50IiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJpbnB1dExpc3QiLCJidXR0b25FbCIsImhhc0ludmFsaWRJbnB1dCIsInNvbWUiLCJpbnB1dCIsInZhbGlkaXR5IiwidmFsaWQiLCJkaXNhYmxlQnV0dG9uIiwiZW5hYmxlQnV0dG9uIiwiZGlzYWJsZWQiLCJhZGQiLCJzZXRCdXR0b25UZXh0IiwiYnRuIiwiaXNMb2FkaW5nIiwiZGVmYXVsdFRleHQiLCJsb2FkaW5nVGV4dCIsImFwaSIsImNvbnN0cnVjdG9yIiwiYmFzZVVybCIsImhlYWRlcnMiLCJ0aGlzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsIl9oYW5kbGVSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJnZXRBcHBJbmZvIiwiYWxsIiwiZ2V0VXNlckluZm8iLCJnZXRJbml0aWFsQ2FyZHMiLCJmZXRjaCIsInRoZW4iLCJlZGl0VXNlckluZm8iLCJuYW1lIiwiYWJvdXQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInVwZGF0ZUF2YXRhciIsImF2YXRhciIsImFkZE5ld0NhcmQiLCJsaW5rIiwiZGVsZXRlQ2FyZCIsImFkZExpa2UiLCJyZW1vdmVMaWtlIiwiYXV0aG9yaXphdGlvbiIsInByb2ZpbGVOYW1lRWwiLCJkb2N1bWVudCIsInByb2ZpbGVEZXNjcmlwdGlvbkVsIiwicHJvZmlsZUF2YXRhckVsIiwiZWRpdFByb2ZpbGVNb2RhbCIsIm5ld1Bvc3RNb2RhbCIsInByZXZpZXdNb2RhbCIsImF2YXRhck1vZGFsIiwiZGVsZXRlTW9kYWwiLCJtb2RhbHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZWRpdFByb2ZpbGVGb3JtIiwiZm9ybXMiLCJuZXdQb3N0Rm9ybSIsImF2YXRhckZvcm0iLCJkZWxldGVGb3JtIiwiZWRpdFByb2ZpbGVCdG4iLCJuZXdQb3N0QnRuIiwiYXZhdGFyTW9kYWxCdG4iLCJlZGl0UHJvZmlsZU5hbWVJbnB1dCIsImVkaXREZXNjcmlwdGlvbklucHV0IiwibmV3UG9zdENhcHRpb24iLCJuZXdQb3N0SW1hZ2VJbnB1dCIsImF2YXRhcklucHV0IiwiZGVsZXRlU3VibWl0QnRuIiwiZWRpdFByb2ZpbGVDbG9zZUJ0biIsIm5ld1Bvc3RDbG9zZUJ0biIsInByZXZpZXdNb2RhbENsb3NlQnRuIiwiYXZhdGFyQ2xvc2VCdG4iLCJhdmF0YXJNb2RhbERlbGV0ZUJ0biIsImNhcmRUZW1wbGF0ZSIsImNvbnRlbnQiLCJjYXJkc0xpc3QiLCJzZWxlY3RlZENhcmQiLCJzZWxlY3RlZENhcmRJZCIsImhhbmRsZUVzY0Nsb3NlIiwiZXZ0Iiwia2V5Iiwib3Blbk1vZGFsIiwiY2xvc2VNb2RhbCIsIm1vZGFsIiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJyZW5kZXJDYXJkIiwiaXRlbSIsImNhcmRFbGVtZW50IiwiZGF0YSIsImNsb25lTm9kZSIsImNhcmRUaXRsZUVsIiwiY2FyZEltYWdlRWwiLCJjYXJkRGVsZXRlQnRuRWwiLCJjYXJkTGlrZUJ0bkVsIiwic3JjIiwiYWx0IiwiaXNMaWtlZCIsImNvbnRhaW5zIiwiX2lkIiwiY2F0Y2giLCJjb25zb2xlIiwiZXJyb3IiLCJjYXJkSWQiLCJoYW5kbGVDYXJkRGVsZXRlIiwicHJldmlld0ltYWdlRWwiLCJwcmV2aWV3TW9kYWxDYXB0aW9uRWwiLCJnZXRDYXJkRWxlbWVudCIsInByZXZlbnREZWZhdWx0IiwiZmluYWxseSIsImZvckVhY2giLCJ0YXJnZXQiLCJ1c2VyRGF0YSIsImNhcmRzIiwidmFsdWUiLCJyZXNldFZhbGlkYXRpb24iLCJBcnJheSIsImZyb20iLCJzdWJtaXRCdG4iLCJzdWJtaXR0ZXIiLCJjYXJkRGF0YSIsIm5ld0NhcmQiLCJyZXNldCIsInNldEV2ZW50TGlzdGVuZXJzIiwiY2hlY2tJbnB1dFZhbGlkaXR5Iiwic2hvd0lucHV0RXJyb3IiLCJlcnJvck1zZyIsInZhbGlkYXRpb25NZXNzYWdlIl0sInNvdXJjZVJvb3QiOiIifQ==